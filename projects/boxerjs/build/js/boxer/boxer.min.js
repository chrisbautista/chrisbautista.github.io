!function(e){var t=function(t){function i(t){var i,n=e(t),o=document.createElement("div");o.className="boxer-closeBtn",d.append(o),i=e(".boxer-closeBtn"),i.css("top",parseInt(n.css("top"))-20+"px"),i.css("left",parseInt(n.css("left"))+parseInt(n.css("width"))+12+"px"),d.on("click",function(){n.remove(),e(this).remove(),e(this).off()})}function n(n){var r,a,h,c,s=n.target;return n.preventDefault(),s="A"!==s.nodeName?n.target.parentNode:s,"A"===s.nodeName&&(r=e(s).attr("data-type")||"",e("body").append(e("<div></div>").addClass(t.overlayName)),d=e("."+t.overlayName),outSideContainer=document.createElement("div"),outSideContainer.id="imgContainer",a=o(s,r,function(){outSideContainer.appendChild(a),e(outSideContainer)[0].firstChild.width?(h=e(outSideContainer)[0].firstChild.width,c=e(outSideContainer)[0].firstChild.height):(h=t.width,c=t.height,e(e(outSideContainer)[0].firstChild).css("width",h),e(e(outSideContainer)[0].firstChild).css("height",c)),(h>.7*e(window).width()||c>.7*e(window).height())&&(h=parseInt(h/2),c=parseInt(c/2),e(outSideContainer)[0].firstChild.width=h),e(outSideContainer)[0].firstChild.width=h,e(outSideContainer).css({top:e(window).height()/2-parseInt(c/2)+"px",left:e(window).width()/2-parseInt(h/2)+"px"}),i(outSideContainer)}),d.append(outSideContainer),t.beforeShow&&t.beforeShow(),!1)}function o(t,i,n){var o,d,r,a;return o=document.createDocumentFragment(),""===i||"image"===i?(d=document.createElement("img"),d.src=t.href,o.appendChild(d),t.title&&(a=document.createElement("p"),r=document.createTextNode(t.title),a.appendChild(r),o.appendChild(a)),d.addEventListener("load",n)):"ajax"===i&&(d=document.createElement("div"),e(d).load(t.href,function(e,t,i){o.appendChild(d),n(e)})),o}var d,r=t.obj;r.off().on("click",n)};e.fn.boxer=function(i){var n=e.extend({overlayName:"previewOverlay",width:600,height:400},i);return this.filter("div").each(function(){e.each(this.children,function(){t(e.extend({obj:e(this)},n))})}),this}}(jQuery);